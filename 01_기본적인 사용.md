# 01. console 객체와 process 객체

## - console

 - dir() : 객체 속성 확인
 - time('id')
 - timeEnd('id')

## - process

 - argv : 프로세스 실행할 때 전달되는 파라미터
 - env : 환경 변수
 - exit()

### * OS 환경 변수의 값
```js
process.env['OS']
```
### * 주요 전역 변수

 - `__filename` : 실행한 파일 이름(Path 전체)
 - `__dirname` : 실행한 파일이 들어있는 폴더(Path 전체)

<br><br><br><br><br>
<hr>
<br><br><br><br><br>



# 02. 모듈 관리

## - 모듈화와 사용 1

### * export
```js
exports.함수이름 = 구현부
```
 - `module.js`
```js
exports.test = function(){
    console.log("모듈 불러옴");
}

exports.test2 = function(){
    console.log("모듈 불러옴2");
}
```

### * import
```js
var module = require('module.js');
module.함수이름();
```
 - `main.js`

```js
let sample = require('./module');
sample.test(); /*모듈 불러옴*/
sample.test2(); /*모듈 불러옴2*/
```

## - 모듈화와 사용 2

### * export
```js
var something = {}

something.프로퍼티 = 구현

module.exports = something;
```

### * Example

 - module.js
```js
let calc = {}

calc.add = (n1, n2) => {
    return n1 + n2;
}

calc.mul = (n1, n2) => {
    return n1 * n2;
}

module.exports = calc;
```


 - main.js
```js
let calc = require('./module');

console.log(calc.add(10, 20)); //30
console.log(calc.mul(10, 20)); //200
```

<br><br><br><br><br>
<hr>
<br><br><br><br><br>

# 03. 시스템 환경 변수에 접근하기 `nconf`

```cmd
npm install nconf
```

```js
let nconf = require('nconf');
nconf.env();

console.log(`OS 환경변수의 값 : ${nconf.get('OS')}`);
```

<br><br><br><br><br>
<hr>
<br><br><br><br><br>

# 04. npm 사용

## * package.json 만들기

```cmd
npm init
```

## * npm 설치/지우기

```cmd
npm uninstall nconf
```

```cmd
npm install nconf --save
```

 - package.json에 정의된 모듈 설치
```cmd
npm install
```


<br><br><br><br><br>
<hr>
<br><br><br><br><br>

# 05. 빌트인

## - `os` 모듈

| 메소드 이름 | 설명 |
|:---:|:---:|
|hostname()| 운영체제의 호스트 이름|
|totalmem()| 시스템의 전체 메모리 용량|
|freemem()| 사용가능한 메모리 용량|
|cpus()|CPU정보|
|networkInterfaces()| 네트워크 인터페이스 정보를 담은 배열|

## - `path` 모듈

| 메소드 이름 | 설명 |
|:---:|:---:|
|join()| 파일 패스 합치기|
|dirname()| 디렉터리 이름 반환|
|basename()| 확장자를 제외한 이름 |
|extname()| 확장자 반환|

### * Example

```js
let path = require('path');

console.log(path.sep); // "\"

let filepath = `WORKSPACE/CodeWorld/GIT-REPO-ARCHIVE/JS/Playground.NodeJS/main.js`

console.log(`dirname : ${path.dirname(filepath)}`);
console.log(`basename : ${path.basename(filepath)}`);
console.log(`extname : ${path.extname(filepath)}`);

/* 
dirname : WORKSPACE/CodeWorld/GIT-REPO-ARCHIVE/JS/Playground.NodeJS
basename : main.js
extname : .js
*/
```


<br><br><br><br><br>
<hr>
<br><br><br><br><br>

# 06. 노드 기본 기능

## - 주소 다루기

### * url 모듈 & querystring 모듈

#### url 모듈

 - `parse()` : 주소 문자열 -> URL 객체
 - `format()` : URL 객체 -> 주소 문자열

#### querystring 모듈

 - `parse()` : 문자열 -> Parameter 객체
 - `stringify()` : Parameter -> 문자열

```js
let url = require('url');
let queryString = require('querystring');

let strUrl = 'https://search.naver.com/search.naver?where=nexearch&sm=top_hty&fbm=1&ie=utf8&query=node.js';

let urlObj = url.parse(strUrl); //deprecated
console.log(strUrl); //https://search.naver.com/search.naver?where=nexearch&sm=top_hty&fbm=1&ie=utf8&query=node.js 
let param = queryString.parse(urlObj.query); //Parameter 객체
console.log(param);
/* 
{
  where: 'nexearch',
  sm: 'top_hty',
  fbm: '1',
  ie: 'utf8',
  query: 'node.js'
}
*/
```



## - 이벤트 처리
 
### * process.
 - `on(event, listener)`
 - `once(event, listener)` : 한번 실행후 자동으로 제거됨
 - `removeListener(event, listener)`
 - `emit(eventName, parameter)` : 사용자 정의 이벤트

```js
process.on('exit', function(){
    console.log('exit 이벤트 발생');
})

process.exit();
```

### * 이벤트 모듈화

process 객체를 이용하여 이벤트를 다루면 이름이 충돌될 수도 있다.
 
 - `module.js`

```js
let util = require('util'); //상속 기능 사용을 위해
let EventEmitter = require('events').EventEmitter //이벤트 리스터 함수들은 이걸 상속받음

let EventObj = function(){

    let that = this;

    that.on("myEvent", function(a, b){
        console.log(`myEvent 발생 : ${a}, ${b}`);
    });
    
};

util.inherits(EventObj, EventEmitter);

module.exports = EventObj;
module.exports.title = "이벤트 테스트";
```

 - `main.js`

```js
let EventObj = require('./module');

console.log(EventObj.title); //이벤트 테스트
new EventObj().emit('myEvent',10,20); //myEvent 발생 : 10, 20
```

## - 파일 다루기

### * fs 모듈

 - `readFile(filename, [encoding], [callback])`
 - `readFileSync(filename, [encoding])`
 - `writeFile(filename, data, encoding='utf8', [callback])`
 - `writeFileSync(filename, data, encoding='utf8')`


#### 파일 쓰기
```js
let fs = require('fs');
let path = require('path');

let fileName = "myFile.txt"

fs.writeFile(
    path.join(__dirname,fileName),
    "This is my file~",
    function(err){
        if(err){
            console.log("Error : " + err);
        }

        console.log(`${fileName} 쓰기 완료`);
    }
);
```

#### 파일 읽기

```js
let fs = require('fs');
let path = require('path');

let fileName = "myFile.txt"

fs.readFile(
    path.join(__dirname,fileName),
    function(err, data){
        if(err){
            console.log("Error : " + err);
        }

        console.log(data.toString()); //This is my file~
        console.log(`${fileName} 읽기 완료`);
    }
);
```

### * 스트림

```js
let fs = require('fs');
let path = require('path');

let infilePath = path.join(__dirname,"myFile.txt");
let outfilePath = path.join(__dirname,"myFile2.txt");

let infile = fs.createReadStream(infilePath, {flags:'r'});
let outfile = fs.createWriteStream(outfilePath, {flags:'w'});

infile.on('data',function(data){
    console.log(`읽은 데이터 ${data}`);
    outfile.write(data);
})

infile.on('end',function(){
    console.log("파일 읽기 종료");
    outfile.end(()=>console.log("파일 쓰기 종료"));
})

/* 
읽은 데이터 This is my file~
파일 읽기 종료
파일 쓰기 종료
*/
```

<br><br><br><br><br>
<hr>
<br><br><br><br><br>

# 07. 웹 서버 기본

## - 기본 틀

```js
let http = require('http');

let server = http.createServer();

let port = 3000;

server.listen(port, function(){
    console.log("서버 시작");
})

server.on('connection', function(socket){
    console.log(socket);
})

server.on('request', function(req,res){
    console.log(req);

    res.writeHead(200, {"Content-Type":"text/html;charset=utf-8"});
    res.write('<!DOCTYPE html>');
    res.write('<html>');
    res.write('<body>');
    res.write('<h1>Hello World</h1>');
    res.write('<body>');
    res.write('</body>');
    res.write('</html>');
    res.end();
})
```

## - Expess.js 적용

### * request --> middleware --> router --> response

```cmd
npm install --save express
```
```cmd
npm show express version
```
 - `app.js`
```js
const express = require('express')
const app = express()
const port = 3000

app.get('/', (req, res) => {
  res.send('Hello World!')
})

app.listen(port, () => {
  console.log(`Example app listening at http://localhost:${port}`)
})
```
### * 메서드와 속성

#### 메서드
 - set() : 서버 설정 setter
 - get() : 서버 설정 getter
 - use() : 미들웨어

#### 속성
 - env : 서버 모드를 설정
 - views : 뷰들이 들어 있는 폴더 또는 폴더 배열 설정
 - view engine : 디폴트로 사용할 뷰 엔진 설정

### * Routing 메서드

```js
const express = require('express')
const app = express()
const port = 3000

app.get('/', function (req, res) {
  res.send('Hello World!');
});


app.post('/', function (req, res) {
  res.send('Got a POST request');
});


app.put('/user', function (req, res) {
  res.send('Got a PUT request at /user');
});


app.delete('/user', function (req, res) {
  res.send('Got a DELETE request at /user');
});

app.listen(port, () => {
  console.log(`Example app listening at http://localhost:${port}`)
})
```

### * 미들웨어

#### 기본 사용법

```js
const express = require('express')
const app = express()
const port = 3000

app.use((req, res, next)=>{
    console.log("첫번째 미들웨어");
    req.name = "RHIE";
    next();
})

app.use((req, res, next)=>{
    console.log("두번째 미들웨어");
    next();
})

app.get('/', (req, res) => {
    res.send(`Hello World! ${req.name}`)
})
  
app.listen(port, () => {
  console.log(`Example app listening at http://localhost:${port}`)
})
```

#### 콜백 함수 배열

```js
const express = require('express')
const app = express()
const port = 3000

app.use(express.static('public'));

var cb0 = function (req, res, next) {
  console.log('CB0');
  next();
}

var cb1 = function (req, res, next) {
  console.log('CB1');
  next();
}

var cb2 = function (req, res) {
  res.send('Hello from C!');
}

app.get('/example/c', [cb0, cb1, cb2]);


app.listen(port, () => {
  console.log(`Example app listening at http://localhost:${port}`)
})
```